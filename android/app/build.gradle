plugins {
    id "com.android.application"  // 안드로이드 애플리케이션을 빌드하는 플러그인
    id 'com.google.gms.google-services'  // Firebase와의 통합을 위한 Google 서비스 플러그인
    id "kotlin-android"  // Kotlin을 사용한 안드로이드 개발을 지원하는 플러그인
    id "dev.flutter.flutter-gradle-plugin"  // Flutter 프로젝트를 빌드하기 위한 플러그인
}

def localProperties = new Properties()
def localPropertiesFile = rootProject.file('local.properties')
if (localPropertiesFile.exists()) {
    localPropertiesFile.withReader('UTF-8') { reader ->
        localProperties.load(reader)
    }
}

// 버전 정보 설정
def flutterVersionCode = localProperties.getProperty('flutter.versionCode')
if (flutterVersionCode == null) {
    flutterVersionCode = '1'
}

def flutterVersionName = localProperties.getProperty('flutter.versionName')
if (flutterVersionName == null) {
    flutterVersionName = '1.0'
}

android {
    namespace "com.example.mango"  // 애플리케이션의 패키지 이름 (Java/Kotlin namespace와 비슷한 역할)
    compileSdkVersion 34  // SDK 버전을 명확한 숫자로 설정 (최신 버전 사용 권장)
    ndkVersion "21.3.6528147"  // 필요한 경우 NDK 버전을 설정 (보통 네이티브 코드 빌드에 사용)

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8  // 자바 8을 사용해 컴파일하도록 설정
        targetCompatibility JavaVersion.VERSION_1_8  // 자바 8과 호환되는 코드로 컴파일되도록 설정
    }

    kotlinOptions {
        jvmTarget = '1.8'  // Kotlin 코드가 자바 8과 호환되도록 설정
    }

    sourceSets {
        main.java.srcDirs += 'src/main/kotlin'  // Kotlin 소스 디렉토리를 추가
    }

    defaultConfig {
        applicationId "com.example.mango"  // 애플리케이션의 고유 ID (변경 필요)
        minSdkVersion 21  // 최소 SDK 버전 설정
        targetSdkVersion 33  // 타겟 SDK 버전 설정 (최신 버전 사용 권장)
        versionCode flutterVersionCode.toInteger()  // 앱 버전 코드 설정
        versionName flutterVersionName  // 앱 버전 이름 설정
        multiDexEnabled true  // 다중 덱스 지원 활성화 (메서드가 많은 경우 필요)
    }

    buildTypes {
        release {
            signingConfig signingConfigs.debug  // 릴리즈 빌드 시 사용하는 서명 설정 (릴리즈에서 실제 서명 정보로 변경 필요)
        }
    }
}

flutter {
    source '../..'  // Flutter 프로젝트의 루트 디렉토리 설정
}

dependencies {
    implementation 'androidx.multidex:multidex:2.0.1'  // 최신 멀티덱스 라이브러리 사용 (AndroidX 버전)
}
